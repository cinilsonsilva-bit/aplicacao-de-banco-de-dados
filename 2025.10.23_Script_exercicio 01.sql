-- CRIAR A BASE DE DADOS
-- LICITACOES_EMPRESARIAIS_NOME;
 
 CREATE DATABASE _ABD_03361_A_LICITACOES_EMPRESARIAIS_NILSON;
 
 USE _ABD_03361_A_LICITACOES_EMPRESARIAIS_NILSON;
 
-- 1 CRIAR A TABELA DE EMPRESAS
-- CAMPOS: ID, NOME, CIDADE, CNPJ
 
 CREATE TABLE EMPRESAS (
    ID INT PRIMARY KEY AUTO_INCREMENT,
    NOME VARCHAR(100) NOT NULL,
    CIDADE VARCHAR(100) NOT NULL,
    CNPJ VARCHAR(18) UNIQUE NOT NULL
);

-- 2 CRIAR A TABELA DE CONTRATOS
-- CAMPOS: ID, ID_EMPRESA, OBJETO, VALOR, DATA_ASSINATURA

CREATE TABLE CONTRATOS (
    ID INT PRIMARY KEY AUTO_INCREMENT,
    ID_EMPRESA INT NOT NULL,
    OBJETO VARCHAR(200) NOT NULL,
    VALOR DECIMAL(12,2) NOT NULL,
    DATA_ASSINATURA DATE NOT NULL,
    FOREIGN KEY (ID_EMPRESA) REFERENCES EMPRESAS(ID)
);
 
-- 3 CRIAR A TABELA DE PAGAMENTOS
-- CAMPOS: ID, ID_CONTRATO, VALOR_PAGO, DATA_PAGAMENTO
 
 CREATE TABLE PAGAMENTOS (
    ID INT PRIMARY KEY AUTO_INCREMENT,
    ID_CONTRATO INT,
    VALOR_PAGO DECIMAL(12,2) NOT NULL,
    DATA_PAGAMENTO DATE NOT NULL,
    FOREIGN KEY (ID_CONTRATO) REFERENCES CONTRATOS(ID)
);

-- 4 POPULAR AS TABELAS COM 50 DADOS CADA

INSERT INTO EMPRESAS (NOME, CIDADE, CNPJ) VALUES
('Construtora Alpha', 'São Paulo', '11.111.111/0001-11'),
('TecnoBuild Ltda', 'Curitiba', '22.222.222/0001-22'),
('Engenho Obras', 'Rio de Janeiro', '33.333.333/0001-33'),
('MegaInfra S.A.', 'Belo Horizonte', '44.444.444/0001-44'),
('Solidez Engenharia', 'Porto Alegre', '55.555.555/0001-55'),
('Futura Construções', 'São Paulo', '66.666.666/0001-66'),
('Beta Projetos', 'Recife', '77.777.777/0001-77'),
('MasterPlan Ltda', 'Curitiba', '88.888.888/0001-88'),
('Delta Empreendimentos', 'Fortaleza', '99.999.999/0001-99'),
('Nova Era Engenharia', 'São Paulo', '10.000.000/0001-10'),
('Skyline Engenharia', 'Salvador', '11.000.000/0001-11'),
('Construmax', 'São Paulo', '12.000.000/0001-12'),
('Obras Unidas', 'Rio de Janeiro', '13.000.000/0001-13'),
('Planobase', 'Curitiba', '14.000.000/0001-14'),
('GeoConstrutora', 'São Paulo', '15.000.000/0001-15'),
('MegaTower', 'Curitiba', '16.000.000/0001-16'),
('Inova Engenharia', 'Porto Alegre', '17.000.000/0001-17'),
('SmartInfra', 'São Paulo', '18.000.000/0001-18'),
('Prime Construções', 'Curitiba', '19.000.000/0001-19'),
('Omega Obras', 'Recife', '20.000.000/0001-20'),
('Construtora Real', 'São Paulo', '21.000.000/0001-21'),
('Alfa & Cia', 'Belo Horizonte', '22.000.000/0001-22'),
('Ribeiro Engenharia', 'São Paulo', '23.000.000/0001-23'),
('Concretiza Ltda', 'Curitiba', '24.000.000/0001-24'),
('Evoluir Engenharia', 'Rio de Janeiro', '25.000.000/0001-25'),
('Base Forte', 'São Paulo', '26.000.000/0001-26'),
('Construtec', 'Curitiba', '27.000.000/0001-27'),
('ArqPlan', 'Porto Alegre', '28.000.000/0001-28'),
('Planeta Obras', 'São Paulo', '29.000.000/0001-29'),
('Nova Fase', 'Fortaleza', '30.000.000/0001-30'),
('Constrói Fácil', 'Curitiba', '31.000.000/0001-31'),
('EcoInfra', 'São Paulo', '32.000.000/0001-32'),
('Pilar Engenharia', 'Recife', '33.000.000/0001-33'),
('BR Construtora', 'Curitiba', '34.000.000/0001-34'),
('Ideal Obras', 'São Paulo', '35.000.000/0001-35'),
('Urbaniza', 'Curitiba', '36.000.000/0001-36'),
('Projeta Engenharia', 'Rio de Janeiro', '37.000.000/0001-37'),
('Construsmart', 'São Paulo', '38.000.000/0001-38'),
('Mundo Novo', 'Curitiba', '39.000.000/0001-39'),
('Realiza Engenharia', 'São Paulo', '40.000.000/0001-40'),
('ObraCerta', 'Curitiba', '41.000.000/0001-41'),
('Engenhar Ltda', 'São Paulo', '42.000.000/0001-42'),
('TorreAlta', 'Curitiba', '43.000.000/0001-43'),
('Construtiva', 'São Paulo', '44.000.000/0001-44'),
('InfraTop', 'Curitiba', '45.000.000/0001-45'),
('TopLine', 'São Paulo', '46.000.000/0001-46'),
('AlphaPrime', 'Curitiba', '47.000.000/0001-47'),
('Engenho Novo', 'São Paulo', '48.000.000/0001-48'),
('Supra Engenharia', 'Curitiba', '49.000.000/0001-49'),
('Consolida Ltda', 'São Paulo', '50.000.000/0001-50'),
('Horizonte Construções', 'São Paulo', '51.000.000/0001-51'),
('Nova Vista Engenharia', 'Curitiba', '52.000.000/0001-52'),
('Ponto Forte Ltda', 'Rio de Janeiro', '53.000.000/0001-53'),
('Construa Bem', 'Porto Alegre', '54.000.000/0001-54'),
('Alpha Engenharia', 'Fortaleza', '55.000.000/0001-55');

SELECT * FROM EMPRESAS;

INSERT INTO CONTRATOS (ID_EMPRESA, OBJETO, VALOR, DATA_ASSINATURA) VALUES
(1, 'Construção de ponte municipal', 500000.00, '2024-03-15'),
(2, 'Reforma de escola pública', 320000.00, '2024-04-10'),
(3, 'Pavimentação de avenida', 780000.00, '2024-01-22'),
(4, 'Construção de hospital', 1250000.00, '2023-12-18'),
(5, 'Reforma de prédio histórico', 280000.00, '2024-02-05'),
(6, 'Construção de viaduto', 890000.00, '2024-03-01'),
(7, 'Manutenção de rodovia', 450000.00, '2024-04-20'),
(8, 'Construção de escola', 610000.00, '2024-05-14'),
(9, 'Construção de estação de tratamento', 720000.00, '2024-06-03'),
(10, 'Projeto de urbanização', 250000.00, '2024-07-07'),
(11, 'Construção de galpão industrial', 300000.00, '2024-03-12'),
(12, 'Ampliação de aeroporto', 950000.00, '2024-04-25'),
(13, 'Reforma de hospital', 400000.00, '2024-02-28'),
(14, 'Construção de túnel', 1150000.00, '2024-06-30'),
(15, 'Projeto elétrico urbano', 200000.00, '2024-01-11'),
(16, 'Construção de conjunto habitacional', 670000.00, '2024-05-09'),
(17, 'Obra de saneamento básico', 580000.00, '2024-02-16'),
(18, 'Reforma de biblioteca', 310000.00, '2024-03-18'),
(19, 'Construção de posto de saúde', 330000.00, '2024-04-27'),
(20, 'Pavimentação de estrada rural', 420000.00, '2024-05-12'),
(21, 'Construção de centro esportivo', 550000.00, '2024-06-08'),
(22, 'Reforma de prédio público', 270000.00, '2024-07-01'),
(23, 'Construção de condomínio', 990000.00, '2024-01-20'),
(24, 'Construção de prédio comercial', 800000.00, '2024-03-04'),
(25, 'Construção de passarela', 190000.00, '2024-04-10'),
(26, 'Construção de ginásio', 470000.00, '2024-05-20'),
(27, 'Obra de drenagem urbana', 260000.00, '2024-06-14'),
(28, 'Construção de estação rodoviária', 740000.00, '2024-02-03'),
(29, 'Reforma de terminal de ônibus', 310000.00, '2024-01-25'),
(30, 'Ampliação de escola', 340000.00, '2024-05-30'),
(31, 'Construção de praça', 220000.00, '2024-07-19'),
(32, 'Construção de passarela para pedestres', 250000.00, '2024-03-11'),
(33, 'Obra de contenção de encosta', 660000.00, '2024-06-22'),
(34, 'Reforma de creche', 280000.00, '2024-02-14'),
(35, 'Construção de condomínio habitacional', 900000.00, '2024-04-02'),
(36, 'Construção de centro cultural', 620000.00, '2024-05-18'),
(37, 'Construção de biblioteca pública', 410000.00, '2024-06-05'),
(38, 'Reforma de estação de metrô', 530000.00, '2024-07-03'),
(39, 'Construção de escola técnica', 720000.00, '2024-03-27'),
(40, 'Obra de iluminação pública', 210000.00, '2024-02-25'),
(41, 'Construção de túnel viário', 1180000.00, '2024-04-21'),
(42, 'Construção de centro administrativo', 830000.00, '2024-05-11'),
(43, 'Reforma de hospital central', 470000.00, '2024-06-01'),
(44, 'Construção de teatro municipal', 880000.00, '2024-07-09'),
(45, 'Obra de ampliação de pista', 620000.00, '2024-03-19'),
(46, 'Construção de centro comunitário', 290000.00, '2024-01-30'),
(47, 'Construção de passarela urbana', 230000.00, '2024-02-27'),
(48, 'Construção de unidade básica de saúde', 310000.00, '2024-04-15'),
(49, 'Reforma de estádio municipal', 540000.00, '2024-05-24'),
(50, 'Construção de estação de trem', 760000.00, '2024-06-10');

SELECT * FROM CONTRATOS;

INSERT INTO PAGAMENTOS (ID_CONTRATO, VALOR_PAGO, DATA_PAGAMENTO) VALUES
(1, 250000.00, '2024-05-10'),
(2, 320000.00, '2024-06-12'),
(3, 400000.00, '2024-05-05'),
(4, 800000.00, '2024-07-01'),
(5, 280000.00, '2024-06-20'),
(6, 890000.00, '2024-06-18'),
(7, 450000.00, '2024-05-22'),
(8, 610000.00, '2024-06-29'),
(9, 720000.00, '2024-07-02'),
(10, 250000.00, '2024-06-30'),
(11, 150000.00, '2024-05-25'),
(12, 950000.00, '2024-07-03'),
(13, 400000.00, '2024-06-12'),
(14, 500000.00, '2024-07-04'),
(15, 200000.00, '2024-05-16'),
(16, 670000.00, '2024-05-28'),
(17, 580000.00, '2024-06-10'),
(18, 310000.00, '2024-06-25'),
(19, 330000.00, '2024-06-18'),
(20, 420000.00, '2024-05-12'),
(21, 550000.00, '2024-06-08'),
(22, 270000.00, '2024-06-30'),
(23, 990000.00, '2024-07-11'),
(24, 800000.00, '2024-07-14'),
(25, 190000.00, '2024-05-17'),
(26, 470000.00, '2024-06-06'),
(27, 260000.00, '2024-05-13'),
(28, 740000.00, '2024-07-02'),
(29, 310000.00, '2024-06-01'),
(30, 340000.00, '2024-06-15'),
(31, 220000.00, '2024-07-19'),
(32, 250000.00, '2024-06-03'),
(33, 660000.00, '2024-06-25'),
(34, 280000.00, '2024-06-21'),
(35, 900000.00, '2024-07-03'),
(36, 620000.00, '2024-07-10'),
(37, 410000.00, '2024-07-05'),
(38, 530000.00, '2024-07-09'),
(39, 720000.00, '2024-06-20'),
(40, 210000.00, '2024-06-22'),
(41, 1180000.00, '2024-07-01'),
(42, 830000.00, '2024-07-04'),
(43, 470000.00, '2024-07-06'),
(44, 880000.00, '2024-07-08'),
(45, 620000.00, '2024-07-09'),
(46, 290000.00, '2024-07-10'),
(47, 230000.00, '2024-07-11'),
(48, 310000.00, '2024-07-12'),
(49, 540000.00, '2024-07-13'),
(50, 760000.00, '2024-07-14');

SELECT * FROM PAGAMENTOS;

-- 1 MOSTRAR TODOS OS CONTRATOS E SUAS EMPRESAS 
-- DICA: USE INNER JOIN
-- MOSTRAR O NOME DA EMPRESA, OBJETO DO CONTRATO E VALOR
 
 SELECT 
    E.NOME AS NOME_EMPRESA,
    C.OBJETO AS OBJETO_CONTRATO,
    C.VALOR AS VALOR_CONTRATO
FROM CONTRATOS C
INNER JOIN EMPRESAS E
    ON C.ID_EMPRESA = E.ID;

-- 2 MOSTRAR TODAS AS EMPRESAS E SEUS CONTRATOS 
-- DICA: USE LEFT JOIN
-- MOSTRAR TAMBÉM AS EMPRESAS QUE AINDA NÃO POSSUEM CONTRATOS
 
 SELECT 
    E.NOME AS NOME_EMPRESA,
    C.OBJETO AS OBJETO_CONTRATO,
    C.VALOR AS VALOR_CONTRATO
FROM EMPRESAS E
LEFT JOIN CONTRATOS C
    ON E.ID = C.ID_EMPRESA;

-- 3 MOSTRAR TODOS OS CONTRATOS E SEUS PAGAMENTOS 
-- DICA: USE RIGHT JOIN
-- MOSTRAR MESMO QUE ALGUM PAGAMENTO NÃO TENHA CONTRATO VÁLIDO
 
 SELECT 
    C.ID AS ID_CONTRATO,
    C.OBJETO AS OBJETO_CONTRATO,
    C.VALOR AS VALOR_CONTRATO,
    P.VALOR_PAGO,
    P.DATA_PAGAMENTO
FROM CONTRATOS C
RIGHT JOIN PAGAMENTOS P
    ON C.ID = P.ID_CONTRATO;

-- 4 MOSTRAR CONTRATOS CUJO VALOR ESTEJA ENTRE 200000 E 600000 
-- E MOSTRAR O NOME DA EMPRESA RESPONSÁVEL
-- DICA: USE INNER JOIN E BETWEEN
 
 SELECT 
    E.NOME AS NOME_EMPRESA,
    C.OBJETO AS OBJETO_CONTRATO,
    C.VALOR AS VALOR_CONTRATO
FROM CONTRATOS C
INNER JOIN EMPRESAS E
    ON C.ID_EMPRESA = E.ID
WHERE C.VALOR BETWEEN 200000 AND 600000;

-- 5 MOSTRAR TODOS OS CONTRATOS COM PAGAMENTOS REALIZADOS ENTRE '2024-05-01' E '2024-06-30' 
-- DICA: USE JOIN E BETWEEN NA DATA
 
 SELECT 
    C.ID AS ID_CONTRATO,
    C.OBJETO AS OBJETO_CONTRATO,
    C.VALOR AS VALOR_CONTRATO,
    P.VALOR_PAGO,
    P.DATA_PAGAMENTO
FROM CONTRATOS C
INNER JOIN PAGAMENTOS P
    ON C.ID = P.ID_CONTRATO
WHERE P.DATA_PAGAMENTO BETWEEN '2024-05-01' AND '2024-06-30'
ORDER BY P.DATA_PAGAMENTO DESC;

-- 6 MOSTRAR OS CONTRATOS COM VALOR MAIOR QUE 300000 
-- MAS APENAS DAS EMPRESAS LOCALIZADAS EM 'São Paulo' OU 'Curitiba'
-- DICA: USE INNER JOIN E WHERE COM IN()
 
 SELECT 
    E.NOME AS NOME_EMPRESA,
    E.CIDADE,
    C.OBJETO AS OBJETO_CONTRATO,
    C.VALOR AS VALOR_CONTRATO
FROM CONTRATOS C
INNER JOIN EMPRESAS E
    ON C.ID_EMPRESA = E.ID
WHERE C.VALOR > 300000
  AND E.CIDADE IN ('São Paulo', 'Curitiba')
ORDER BY C.VALOR ASC;

-- 7 MOSTRAR O TOTAL PAGO POR CONTRATO 
-- DICA: USE INNER JOIN, SUM() E AS PARA CRIAR UMA COLUNA CHAMADA TOTAL_PAGO
 
 SELECT 
    C.ID AS ID_CONTRATO,
    C.OBJETO AS OBJETO_CONTRATO,
    C.VALOR AS VALOR_CONTRATO,
    SUM(P.VALOR_PAGO) AS TOTAL_PAGO
FROM CONTRATOS C
INNER JOIN PAGAMENTOS P
    ON C.ID = P.ID_CONTRATO
GROUP BY C.ID, C.OBJETO, C.VALOR;

-- 8 MOSTRAR AS EMPRESAS QUE AINDA NÃO RECEBERAM NENHUM PAGAMENTO 
-- DICA: USE LEFT JOIN E WHERE IS NULL
 
 SELECT 
    E.NOME AS NOME_EMPRESA,
    E.CIDADE
FROM EMPRESAS E
LEFT JOIN CONTRATOS C
    ON E.ID = C.ID_EMPRESA
LEFT JOIN PAGAMENTOS P
    ON C.ID = P.ID_CONTRATO
WHERE P.ID IS NULL;

-- 9 MOSTRAR OS CONTRATOS CUJO OBJETO CONTENHA A PALAVRA 'CONSTRUÇÃO' 
-- DICA: USE LIKE '%CONSTRUÇÃO%'
 
 SELECT 
    C.ID AS ID_CONTRATO,
    C.OBJETO AS OBJETO_CONTRATO,
    C.VALOR AS VALOR_CONTRATO,
    E.NOME AS NOME_EMPRESA
FROM CONTRATOS C
INNER JOIN EMPRESAS E
    ON C.ID_EMPRESA = E.ID
WHERE C.OBJETO LIKE '%CONSTRUÇÃO%';

-- 10 DESAFIO: MOSTRAR UM RELATÓRIO COMPLETO COM:
-- NOME DA EMPRESA, CIDADE, OBJETO DO CONTRATO, VALOR, VALOR_PAGO, DATA_PAGAMENTO
-- DICA: USE INNER JOIN ENTRE AS 3 TABELAS (EMPRESAS, CONTRATOS, PAGAMENTOS)

SELECT 
    E.NOME AS NOME_EMPRESA,
    E.CIDADE,
    C.OBJETO AS OBJETO_CONTRATO,
    C.VALOR AS VALOR_CONTRATO,
    P.VALOR_PAGO,
    P.DATA_PAGAMENTO
FROM EMPRESAS E
LEFT JOIN CONTRATOS C
    ON E.ID = C.ID_EMPRESA
LEFT JOIN PAGAMENTOS P
    ON C.ID = P.ID_CONTRATO
ORDER BY E.NOME;

-- 2025/10/23
-- 1 SUBQUERY SIMPLES (SELECT DENTRO DE SELECT)
-- MOSTRAR TODOS OS CONTRATOS CUJO VALOR É MAIOR QUE A MÉDIA DE VALORES DE TODOS OS CONTRATOS.
-- DICA: USE (SELECT AVG(valor) FROM contratos)
 
 SELECT 
    C.ID AS ID_CONTRATO,
    E.NOME AS NOME_EMPRESA,
    C.OBJETO AS OBJETO_CONTRATO,
    C.VALOR AS VALOR_CONTRATO
FROM CONTRATOS C
JOIN EMPRESAS E
    ON C.ID_EMPRESA = E.ID
WHERE C.VALOR > (
    SELECT AVG(VALOR) 
    FROM CONTRATOS
);

-- 2 SUBQUERY NO WHERE
-- MOSTRAR OS PAGAMENTOS CUJO VALOR SEJA MAIOR QUE O VALOR MÉDIO DOS PAGAMENTOS.
-- DICA: SELECT * FROM pagamentos WHERE valor > (SELECT AVG(valor) FROM pagamentos)
 
 SELECT *
    FROM PAGAMENTOS P
WHERE P.VALOR_PAGO > (
    SELECT AVG(VALOR_PAGO)
    FROM PAGAMENTOS
);

-- 3 SUBQUERY COM IN
-- MOSTRAR TODAS AS EMPRESAS QUE POSSUEM CONTRATOS COM VALOR ACIMA DE 300000.
-- DICA: USE IN COM UMA SUBQUERY NA TABELA DE CONTRATOS.
 
 SELECT *
    FROM EMPRESAS E
WHERE E.ID IN (
    SELECT C.ID_EMPRESA
    FROM CONTRATOS C
    WHERE C.VALOR > 300000
);

-- 4 SUBQUERY COM EXISTS
-- MOSTRAR OS CONTRATOS PARA OS QUAIS EXISTEM PAGAMENTOS REGISTRADOS.
-- DICA: USE EXISTS (SELECT * FROM pagamentos WHERE pagamentos.id_contrato = contratos.id)
 
SELECT 
    C.ID AS ID_CONTRATO,
    E.NOME AS NOME_EMPRESA,
    C.OBJETO AS OBJETO_CONTRATO,
    C.VALOR AS VALOR_CONTRATO
FROM CONTRATOS C
JOIN EMPRESAS E
    ON C.ID_EMPRESA = E.ID
WHERE EXISTS (
    SELECT *
    FROM PAGAMENTOS P
    WHERE P.ID_CONTRATO = C.ID
);

-- 5 SUBQUERY NO FROM (TABELA DERIVADA)
-- MOSTRAR A MÉDIA DE VALOR DE CONTRATOS POR EMPRESA.
-- DICA: USE UMA SUBQUERY NO FROM QUE AGRUPE OS CONTRATOS POR ID_EMPRESA.
 
 SELECT 
    E.NOME AS NOME_EMPRESA,
    T.MEDIA_VALOR AS MEDIA_VALOR_CONTRATOS
FROM EMPRESAS E
INNER JOIN (
    SELECT 
        ID_EMPRESA,
        AVG(VALOR) AS MEDIA_VALOR
    FROM CONTRATOS
    GROUP BY ID_EMPRESA
) T
    ON E.ID = T.ID_EMPRESA
ORDER BY T.MEDIA_VALOR DESC;

-- 6 SUBQUERY COM ORDER BY
-- MOSTRAR OS 3 CONTRATOS MAIS CAROS USANDO SUBQUERY.
-- DICA: USE ORDER BY E LIMIT DENTRO DE UMA SUBQUERY.
 
 SELECT 
    C.ID AS ID_CONTRATO,
    C.OBJETO AS OBJETO_CONTRATO,
    C.VALOR AS VALOR_CONTRATO,
    C.ID_EMPRESA AS ID_EMPRESA
FROM CONTRATOS C
INNER JOIN (
    SELECT ID
    FROM CONTRATOS
    ORDER BY VALOR DESC
    LIMIT 3
) T
    ON C.ID = T.ID;

-- 7 SUBQUERY ANINHADA
-- MOSTRAR AS EMPRESAS CUJO CONTRATO MAIS CARO É SUPERIOR AO MAIOR PAGAMENTO REGISTRADO.
-- DICA: UMA SUBQUERY PARA PEGAR O MAIOR PAGAMENTO E OUTRA PARA PEGAR O CONTRATO MAIS CARO DE CADA EMPRESA.
 
-- 8 SUBQUERY EM UPDATE
-- ATUALIZAR TODOS OS CONTRATOS E AUMENTAR EM 10% O VALOR DOS CONTRATOS QUE ESTÃO ABAIXO DA MÉDIA GERAL.
-- DICA: UPDATE contratos SET valor = valor * 1.10 WHERE valor < (SELECT AVG(valor) FROM contratos)
 
-- 9 SUBQUERY COM DELETE
-- APAGAR TODOS OS PAGAMENTOS QUE NÃO POSSUEM CONTRATO ASSOCIADO.
-- DICA: DELETE FROM pagamentos WHERE id_contrato NOT IN (SELECT id FROM contratos)
 
-- 10 SUBQUERY COM JOIN E FILTRO FINAL
-- MOSTRAR AS EMPRESAS QUE POSSUEM CONTRATOS E PAGAMENTOS COM VALOR MÉDIO MAIOR QUE 400000.
-- DICA: USE UMA SUBQUERY QUE CALCULE A MÉDIA DE PAGAMENTOS POR CONTRATO.



